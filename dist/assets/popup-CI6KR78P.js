import{r as s,g as T,a as D,e as O,b as z,j as e,m as w,s as V,c as W,d as Z,f as P}from"./motion-CRX9Jpgj.js";import{c as H,d as I}from"./categories-Cv2C5qUu.js";function q({title:t,titleId:o,...a},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":o},a),t?s.createElement("title",{id:o},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"}))}const Q=s.forwardRef(q);function _({title:t,titleId:o,...a},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":o},a),t?s.createElement("title",{id:o},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z"}))}const G=s.forwardRef(_);function J({title:t,titleId:o,...a},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":o},a),t?s.createElement("title",{id:o},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"}))}const K=s.forwardRef(J);function X(t){if(!t)return"/icons/icon48.png";try{return`https://icons.duckduckgo.com/ip3/${t}.ico`}catch{return"/icons/icon48.png"}}function Y(t){const o=Math.floor(t/60),a=t%60;return`${o}m ${a}s`}function ee({value:t=0}){return e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-pink-500 h-2",style:{width:`${Math.min(100,t)}%`}})})}function te(){const[t,o]=s.useState(null),[a,l]=s.useState(0),[c,g]=s.useState(null),[y,m]=s.useState(!1),[N,L]=s.useState(null),[f,b]=s.useState("auto"),[u,M]=s.useState([0,0,0,0,0,0,0]);s.useEffect(()=>{(async()=>{const i=(await new Promise(h=>chrome.tabs.query({active:!0,lastFocusedWindow:!0},h)))[0],r=i&&i.url?new URL(i.url).hostname:null;o(r);const d=await T(["usage","limits","blocked"]);l(d.usage&&d.usage[r]||0),g(d.limits&&d.limits[r]||null);const B=d.blocked&&d.blocked[r];if(m(!!B),r){L(X(r));const h=await D(r);M(h.map(A=>Math.round(A/60)));const v=H(r),F=I(v);await O(r,v,F)}const p=(await z()).theme||"light";b(p),document.documentElement.classList.toggle("dark",p==="dark")})()},[]);async function x(n){if(!t)return;const i=parseInt(n,10);isNaN(i)||i<=0||(await V(t,i),g(i))}function E(){chrome.runtime.sendMessage({action:"block-now",domain:t},()=>{m(!0)})}function S(){chrome.runtime.sendMessage({action:"unblock",domain:t},()=>{m(!1)})}function C(){const n=f==="dark"?"light":"dark";b(n),W({theme:n}),document.documentElement.classList.toggle("dark",n==="dark")}function j(){return c?Math.round(a/(c*60)*100):0}async function R(){const n=await Z(),i=URL.createObjectURL(new Blob([n],{type:"text/csv"})),r=document.createElement("a");r.href=i,r.download="sitefuse_usage.csv",r.click(),URL.revokeObjectURL(i)}function $(n=5){chrome.runtime.sendMessage({action:"snooze",domain:t,minutes:n},i=>{})}const U=c&&c>0&&a>0&&a/(c*60)>.75||!c&&a>60*30;return e.jsx("div",{className:"min-w-[320px] p-4 font-sans",children:e.jsxs(w.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:N,alt:"favicon",className:"w-8 h-8 rounded-sm"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-300",children:"Active"}),e.jsx("div",{className:"text-lg font-semibold truncate",children:t||"â€”"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{"aria-label":"Theme toggle",className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800",onClick:C,children:f==="dark"?e.jsx(K,{className:"w-5 h-5"}):e.jsx(Q,{className:"w-5 h-5"})}),e.jsx("a",{className:"text-sm text-gray-500 dark:text-gray-300",href:"options.html",children:"Settings"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Today"}),e.jsx("div",{className:"text-2xl font-bold",children:Y(a)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Limit"}),e.jsx("div",{className:"text-lg font-semibold",children:c?`${c} min`:"None"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(ee,{value:j()}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[j(),"% used"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Quick set limit"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white",onClick:()=>x(10),children:"10m"}),e.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white",onClick:()=>x(25),children:"25m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Actions"}),e.jsx("div",{className:"flex gap-2 mt-2",children:y?e.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-green-600 text-white",onClick:S,children:"Unblock"}):e.jsxs("button",{className:"flex-1 px-3 py-2 rounded bg-red-600 text-white",onClick:E,children:[e.jsx(G,{className:"w-4 h-4 inline-block mr-2"}),"Block"]})})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Last 7 days (minutes)"}),e.jsx("div",{className:"flex items-end gap-2 h-20",children:u.map((n,i)=>e.jsx(w.div,{initial:{height:2},animate:{height:`${Math.max(4,n/(Math.max(...u)||1)*80)}%`},className:"w-full bg-indigo-200 dark:bg-indigo-800 rounded-t",style:{height:`${Math.max(4,n/(Math.max(...u)||1)*100)}%`},title:`${n}m`},i))}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded border",onClick:R,children:"Export CSV"}),e.jsx("button",{className:"px-3 py-2 rounded border",onClick:()=>$(5),children:"Snooze 5m"}),U?e.jsx("button",{className:"px-3 py-2 rounded bg-yellow-500 text-white",onClick:()=>x(Math.max(10,Math.floor(a/60))),children:"Suggest Limit"}):null]})]})]})})}const k=document.getElementById("root");k&&P(k).render(e.jsx(te,{}));
