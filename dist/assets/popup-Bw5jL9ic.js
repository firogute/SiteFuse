import{r as s,g as k,a as P,e as H,b as I,c as q,d as Q,j as e,m as M,s as _,f as G,h as J,i as K}from"./motion-DwP4X8xh.js";import{c as X,d as Y}from"./categories-Cv2C5qUu.js";function ee({title:t,titleId:r,...i},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":r},i),t?s.createElement("title",{id:r},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"}))}const te=s.forwardRef(ee);function se({title:t,titleId:r,...i},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":r},i),t?s.createElement("title",{id:r},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z"}))}const ae=s.forwardRef(se);function ne({title:t,titleId:r,...i},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":r},i),t?s.createElement("title",{id:r},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"}))}const ie=s.forwardRef(ne);function re(t){if(!t)return"/icons/icon48.png";try{return`https://icons.duckduckgo.com/ip3/${t}.ico`}catch{return"/icons/icon48.png"}}function ce(t){const r=Math.floor(t/60),i=t%60;return`${r}m ${i}s`}function oe({value:t=0}){return e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-pink-500 h-2",style:{width:`${Math.min(100,t)}%`}})})}function le(){const[t,r]=s.useState(null),[i,l]=s.useState(0),[o,j]=s.useState(null),[L,u]=s.useState(!1),[C,E]=s.useState(null),[b,p]=s.useState("auto"),[h,R]=s.useState([0,0,0,0,0,0,0]),[v,$]=s.useState({}),[A,B]=s.useState([]),[N,U]=s.useState({current:0,best:0});s.useEffect(()=>{(async()=>{const n=(await new Promise(m=>chrome.tabs.query({active:!0,lastFocusedWindow:!0},m)))[0],c=n&&n.url?new URL(n.url).hostname:null;r(c);const d=await k(["usage","limits","blocked"]);l(d.usage&&d.usage[c]||0),j(d.limits&&d.limits[c]||null);const W=d.blocked&&d.blocked[c];if(u(!!W),c){E(re(c));const m=await P(c);R(m.map(Z=>Math.round(Z/60)));const x=X(c),f=Y(x);await H(c,x,f)}const w=(await I()).theme||"light";p(w),document.documentElement.classList.toggle("dark",w==="dark");try{const m=await q();$(m);const x=await Q(6);B(x);const f=await k(["streaks"]);U(f.streaks||{current:0,best:0})}catch{}})()},[]);async function g(a){if(!t)return;const n=parseInt(a,10);isNaN(n)||n<=0||(await _(t,n),j(n))}function T(){chrome.runtime.sendMessage({action:"block-now",domain:t},()=>{u(!0)})}function D(){chrome.runtime.sendMessage({action:"unblock",domain:t},()=>{u(!1)})}function F(){const a=b==="dark"?"light":"dark";p(a),G({theme:a}),document.documentElement.classList.toggle("dark",a==="dark")}function y(){return o?Math.round(i/(o*60)*100):0}async function O(){const a=await J(),n=URL.createObjectURL(new Blob([a],{type:"text/csv"})),c=document.createElement("a");c.href=n,c.download="sitefuse_usage.csv",c.click(),URL.revokeObjectURL(n)}function z(a=5){chrome.runtime.sendMessage({action:"snooze",domain:t,minutes:a},n=>{})}const V=o&&o>0&&i>0&&i/(o*60)>.75||!o&&i>60*30;return e.jsx("div",{className:"min-w-[320px] p-4 font-sans",children:e.jsxs(M.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:C,alt:"favicon",className:"w-8 h-8 rounded-sm"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-300",children:"Active"}),e.jsx("div",{className:"text-lg font-semibold truncate",children:t||"—"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{"aria-label":"Theme toggle",className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800",onClick:F,children:b==="dark"?e.jsx(ie,{className:"w-5 h-5"}):e.jsx(te,{className:"w-5 h-5"})}),e.jsx("a",{className:"text-sm text-gray-500 dark:text-gray-300",href:"options.html",children:"Settings"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Today"}),e.jsx("div",{className:"text-2xl font-bold",children:ce(i)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Limit"}),e.jsx("div",{className:"text-lg font-semibold",children:o?`${o} min`:"None"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(oe,{value:y()}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[y(),"% used"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Quick set limit"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white",onClick:()=>g(10),children:"10m"}),e.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white",onClick:()=>g(25),children:"25m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Actions"}),e.jsx("div",{className:"flex gap-2 mt-2",children:L?e.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-green-600 text-white",onClick:D,children:"Unblock"}):e.jsxs("button",{className:"flex-1 px-3 py-2 rounded bg-red-600 text-white",onClick:T,children:[e.jsx(ae,{className:"w-4 h-4 inline-block mr-2"}),"Block"]})})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Last 7 days (minutes)"}),e.jsx("div",{className:"flex items-end gap-2 h-20",children:h.map((a,n)=>e.jsx(M.div,{initial:{height:2},animate:{height:`${Math.max(4,a/(Math.max(...h)||1)*80)}%`},className:"w-full bg-indigo-200 dark:bg-indigo-800 rounded-t",style:{height:`${Math.max(4,a/(Math.max(...h)||1)*100)}%`},title:`${a}m`},n))}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded border",onClick:O,children:"Export CSV"}),e.jsx("button",{className:"px-3 py-2 rounded border",onClick:()=>z(5),children:"Snooze 5m"}),V?e.jsx("button",{className:"px-3 py-2 rounded bg-yellow-500 text-white",onClick:()=>g(Math.max(10,Math.floor(i/60))),children:"Suggest Limit"}):null]})]}),e.jsxs("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Analytics"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Streaks: ",e.jsx("span",{className:"font-semibold",children:N.current})," / Best ",e.jsx("span",{className:"font-semibold",children:N.best})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"By Category (minutes)"}),e.jsxs("div",{className:"flex gap-2 items-end h-20",children:[Object.keys(v).length===0&&e.jsx("div",{className:"text-xs text-gray-500",children:"No data"}),Object.entries(v).map(([a,n])=>e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"h-full flex items-end",children:e.jsx("div",{className:"mx-auto bg-indigo-400 rounded-t",style:{height:`${Math.max(4,Math.min(100,Math.round(n/60)))}%`,width:"60%"}})}),e.jsx("div",{className:"text-xs mt-1",children:a})]},a))]})]}),e.jsxs("div",{className:"w-36",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Top Sites"}),e.jsx("ul",{className:"text-sm",children:A.map(a=>e.jsxs("li",{className:"truncate",children:[a.domain," — ",Math.round(a.seconds/60),"m"]},a.domain))})]})]})]})]})})}const S=document.getElementById("root");S&&K(S).render(e.jsx(le,{}));
