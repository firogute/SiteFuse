import{r as t,g as W,j as e,a as Z,b as P,c as I,e as q,d as Q,f as _,h as G,i as J,m as d,s as K,k as X,l as Y,n as ee}from"./motion-CCUwB1ix.js";import{c as se,d as te}from"./categories-Cv2C5qUu.js";function ae(){const[s,i]=t.useState({});t.useEffect(()=>{(async()=>i(await W()))()},[]);const n=Object.keys(s);return n.length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"No badges yet"}):e.jsx("div",{className:"flex gap-2 items-center",role:"list",children:n.map(r=>e.jsxs("div",{role:"listitem",className:"p-2 bg-yellow-100 rounded shadow-sm text-xs",children:[e.jsx("div",{className:"font-semibold",children:r}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(s[r].awardedAt).toLocaleDateString()})]},r))})}function ne({days:s=30}){const[i,n]=t.useState([]);return t.useEffect(()=>{(async()=>n(await Z(s)))()},[s]),e.jsx("div",{className:"grid grid-cols-7 gap-1","aria-label":"Streak calendar",children:i.map(r=>e.jsx("div",{title:r.date,className:`w-6 h-6 rounded ${r.success?"bg-green-500":"bg-gray-300 dark:bg-gray-700"}`},r.date))})}function ie({title:s,titleId:i,...n},r){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":i},n),s?t.createElement("title",{id:i},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"}))}const le=t.forwardRef(ie);function re({title:s,titleId:i,...n},r){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":i},n),s?t.createElement("title",{id:i},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z"}))}const ce=t.forwardRef(re);function oe({title:s,titleId:i,...n},r){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":i},n),s?t.createElement("title",{id:i},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"}))}const de=t.forwardRef(oe);function me(s){if(!s)return"/icons/icon48.png";try{return`https://icons.duckduckgo.com/ip3/${s}.ico`}catch{return"/icons/icon48.png"}}function xe(s){const i=Math.floor(s/60),n=s%60;return`${i}m ${n}s`}function ge({value:s=0}){return e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-pink-500 h-2",style:{width:`${Math.min(100,s)}%`}})})}function he(){const[s,i]=t.useState(null),[n,r]=t.useState(0),[o,b]=t.useState(null),[M,h]=t.useState(!1),[C,L]=t.useState(null),[v,p]=t.useState("auto"),[u,E]=t.useState([0,0,0,0,0,0,0]),[y,B]=t.useState({}),[T,$]=t.useState([]),[w,R]=t.useState({current:0,best:0});t.useEffect(()=>{(async()=>{const l=(await new Promise(x=>chrome.tabs.query({active:!0,lastFocusedWindow:!0},x)))[0],c=l&&l.url?new URL(l.url).hostname:null;i(c);const m=await P(["usage","limits","blocked"]);r(m.usage&&m.usage[c]||0),b(m.limits&&m.limits[c]||null);const z=m.blocked&&m.blocked[c];if(h(!!z),c){L(me(c));const x=await I(c);E(x.map(V=>Math.round(V/60)));const g=se(c),j=te(g);await q(c,g,j)}const k=(await Q()).theme||"light";p(k),document.documentElement.classList.toggle("dark",k==="dark");try{const x=await _();B(x);const g=await G(6);$(g);const j=await J();R(j)}catch{}})()},[]);async function f(a){if(!s)return;const l=parseInt(a,10);isNaN(l)||l<=0||(await K(s,l),b(l))}function A(){chrome.runtime.sendMessage({action:"block-now",domain:s},()=>{h(!0)})}function D(){chrome.runtime.sendMessage({action:"unblock",domain:s},()=>{h(!1)})}function U(){const a=v==="dark"?"light":"dark";p(a),X({theme:a}),document.documentElement.classList.toggle("dark",a==="dark")}function N(){return o?Math.round(n/(o*60)*100):0}async function F(){const a=await Y(),l=URL.createObjectURL(new Blob([a],{type:"text/csv"})),c=document.createElement("a");c.href=l,c.download="sitefuse_usage.csv",c.click(),URL.revokeObjectURL(l)}function O(a=5){chrome.runtime.sendMessage({action:"snooze",domain:s,minutes:a},l=>{})}const H=o&&o>0&&n>0&&n/(o*60)>.75||!o&&n>60*30;return e.jsx("div",{className:"min-w-[320px] p-4 font-sans",children:e.jsxs(d.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:C,alt:`${s||"site"} favicon`,className:"w-8 h-8 rounded-sm"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-300",children:"Active"}),e.jsx("div",{className:"text-lg font-semibold truncate",children:s||"—"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d.button,{"aria-label":"Theme toggle",whileHover:{scale:1.05},whileTap:{scale:.98},className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 sf-transition focus-ring",onClick:U,children:v==="dark"?e.jsx(de,{className:"w-5 h-5"}):e.jsx(le,{className:"w-5 h-5"})}),e.jsx("a",{className:"text-sm text-gray-500 dark:text-gray-300 focus-ring",href:"options.html",children:"Settings"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Today"}),e.jsx("div",{className:"text-2xl font-bold","aria-live":"polite",children:xe(n)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Limit"}),e.jsx("div",{className:"text-lg font-semibold",children:o?`${o} min`:"None"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(ge,{value:N()}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2","aria-hidden":!1,children:[N(),"% used"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Quick set limit"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(d.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white sf-transition focus-ring",onClick:()=>f(10),children:"10m"}),e.jsx(d.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white sf-transition focus-ring",onClick:()=>f(25),children:"25m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Actions"}),e.jsx("div",{className:"flex gap-2 mt-2",children:M?e.jsx(d.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex-1 px-3 py-2 rounded bg-green-600 text-white sf-transition focus-ring",onClick:D,children:"Unblock"}):e.jsxs(d.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex-1 px-3 py-2 rounded bg-red-600 text-white sf-transition focus-ring",onClick:A,children:[e.jsx(ce,{className:"w-4 h-4 inline-block mr-2"}),"Block"]})})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Last 7 days (minutes)"}),e.jsx("div",{className:"flex items-end gap-2 h-20",children:u.map((a,l)=>e.jsx(d.div,{initial:{height:2},animate:{height:`${Math.max(4,a/(Math.max(...u)||1)*80)}%`},className:"w-full bg-indigo-200 dark:bg-indigo-800 rounded-t",style:{height:`${Math.max(4,a/(Math.max(...u)||1)*100)}%`},title:`${a}m`},l))}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded border",onClick:F,children:"Export CSV"}),e.jsx("button",{className:"px-3 py-2 rounded border",onClick:()=>O(5),children:"Snooze 5m"}),H?e.jsx("button",{className:"px-3 py-2 rounded bg-yellow-500 text-white",onClick:()=>f(Math.max(10,Math.floor(n/60))),children:"Suggest Limit"}):null]})]}),e.jsxs("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded",role:"region","aria-labelledby":"analytics-heading",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{id:"analytics-heading",className:"text-sm font-semibold",children:"Analytics"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Streaks: ",e.jsx("span",{className:"font-semibold",children:w.current})," / Best ",e.jsx("span",{className:"font-semibold",children:w.best})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"By Category (minutes)"}),e.jsxs("div",{className:"flex gap-2 items-end h-20",children:[Object.keys(y).length===0&&e.jsx("div",{className:"text-xs text-gray-500",children:"No data"}),Object.entries(y).map(([a,l])=>e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"h-full flex items-end",children:e.jsx("div",{className:"mx-auto bg-indigo-400 rounded-t",style:{height:`${Math.max(4,Math.min(100,Math.round(l/60)))}%`,width:"60%"}})}),e.jsx("div",{className:"text-xs mt-1",children:a})]},a))]})]}),e.jsxs("div",{className:"w-36",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Top Sites"}),e.jsx("ul",{className:"text-sm",children:T.map(a=>e.jsxs("li",{className:"truncate",children:[a.domain," — ",Math.round(a.seconds/60),"m"]},a.domain))})]})]})]}),e.jsx("div",{className:"mt-3 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Badges"}),e.jsx(ae,{})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Streaks"}),e.jsx(ne,{days:30})]})]})})]})})}const S=document.getElementById("root");S&&ee(S).render(e.jsx(he,{}));
