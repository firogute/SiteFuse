import{r as n,b as g,g as v,f as D,j as e,m as L,s as k,k as E,u as R,l as I,n as w,o as B,p as O,i as $}from"./motion-DwP4X8xh.js";import{k as S,d as A}from"./categories-Cv2C5qUu.js";function F({title:t,titleId:a,...o},l){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":a},o),t?n.createElement("title",{id:a},t):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const M=n.forwardRef(F);function T(t){if(!t)return"0m 0s";const a=Math.floor(t/60),o=t%60;return`${a}m ${o}s`}function U({category:t}){const[a,o]=n.useState("");n.useEffect(()=>{(async()=>{const m=(await v(["categoryDefaults"])).categoryDefaults||{};o(m[t]||"")})()},[t]);async function l(){const d=parseInt(a,10);if(isNaN(d))return;const u=(await v(["categoryDefaults"])).categoryDefaults||{};u[t]=d,await D({categoryDefaults:u})}return e.jsxs("div",{className:"p-2 border rounded",children:[e.jsx("div",{className:"text-xs text-gray-500",children:t}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("input",{className:"flex-1 p-1 rounded border text-sm",value:a,onChange:d=>o(d.target.value)}),e.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white text-sm",onClick:l,children:"Save"})]})]})}function W({onAdd:t}){const[a,o]=n.useState("category"),[l,d]=n.useState("social"),[m,u]=n.useState([1,2,3,4,5]),[p,y]=n.useState("21:00"),[j,f]=n.useState("07:00");function b(i){u(x=>x.includes(i)?x.filter(s=>s!==i):x.concat([i]))}async function N(){await O({type:a,target:l,days:m,start:p,end:j,enabled:!0}),t&&t()}return e.jsxs("div",{className:"p-3 border rounded mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("select",{value:a,onChange:i=>o(i.target.value),className:"p-2 rounded border",children:[e.jsx("option",{value:"category",children:"Category"}),e.jsx("option",{value:"domain",children:"Domain"})]}),e.jsx("input",{className:"p-2 rounded border flex-1",value:l,onChange:i=>d(i.target.value),placeholder:"category or domain"})]}),e.jsx("div",{className:"mt-2 text-sm text-gray-500",children:"Days"}),e.jsx("div",{className:"flex gap-1 mt-1",children:[0,1,2,3,4,5,6].map(i=>e.jsx("button",{onClick:()=>b(i),className:`px-2 py-1 rounded ${m.includes(i)?"bg-indigo-600 text-white":"border"}`,children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][i]},i))}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("input",{type:"time",value:p,onChange:i=>y(i.target.value),className:"p-2 rounded border"}),e.jsx("input",{type:"time",value:j,onChange:i=>f(i.target.value),className:"p-2 rounded border"}),e.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white",onClick:N,children:"Add Schedule"})]})]})}function q({refreshKey:t}){const[a,o]=n.useState([]);return n.useEffect(()=>{(async()=>{const l=await w();o(l)})()},[t]),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Schedules"}),e.jsxs("div",{className:"space-y-2",children:[a.length===0&&e.jsx("div",{className:"text-sm text-gray-500",children:"No schedules configured."}),a.map(l=>e.jsxs("div",{className:"p-2 border rounded flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:l.type})," — ",l.target]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[l.days.join(", ")," ",l.start," — ",l.end]})]}),e.jsx("div",{children:e.jsx("button",{className:"px-2 py-1 rounded border mr-2",onClick:async()=>{await B(l.id),o(await w())},children:"Remove"})})]},l.id))]})]})}function H(){const[t,a]=n.useState({limits:{},blocked:{},usage:{}}),[o,l]=n.useState(""),[d,m]=n.useState({}),[u,p]=n.useState(""),[y,j]=n.useState("");n.useEffect(()=>{(async()=>{const s=await g();if(a({limits:s.limits||{},blocked:s.blocked||{},usage:s.usage||{}}),!(await v(["categoryDefaults"])).categoryDefaults){const c={};for(const h of S())c[h]=A(h);await D({categoryDefaults:c})}})()},[]);const f=n.useMemo(()=>{const s=new Set([...Object.keys(t.limits||{}),...Object.keys(t.blocked||{}),...Object.keys(t.usage||{})]);return Array.from(s).filter(r=>r.includes(o)).sort()},[t,o]);async function b(){const s=u.trim(),r=parseInt(y,10);if(!s||isNaN(r))return;await k(s,r);const c=await g();a({limits:c.limits||{},blocked:c.blocked||{},usage:c.usage||{}}),p(""),j("")}async function N(s){await E(s);const r=await g();a({limits:r.limits||{},blocked:r.blocked||{},usage:r.usage||{}})}async function i(s){!!t.blocked[s]?await R(s):await I(s);const c=await g();a({limits:c.limits||{},blocked:c.blocked||{},usage:c.usage||{}})}async function x(s){const r=Object.keys(d).filter(h=>d[h]);for(const h of r)await k(h,s);const c=await g();a({limits:c.limits||{},blocked:c.blocked||{},usage:c.usage||{}})}return e.jsx("div",{className:"p-6 w-full font-sans",children:e.jsxs(L.div,{initial:{opacity:0,y:-6},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-900 p-6 rounded-xl shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"SiteFuse — Domains"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage tracked domains and limits"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{placeholder:"Search domains",className:"p-2 rounded border",value:o,onChange:s=>l(s.target.value)}),e.jsx("button",{className:"px-3 py-2 rounded border text-sm",onClick:()=>{m({}),l("")},children:"Reset"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Category Defaults"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:S().map(s=>e.jsx(U,{category:s},s))})]}),e.jsx(W,{onAdd:async()=>{const s=await g();a({limits:s.limits||{},blocked:s.blocked||{},usage:s.usage||{}})}}),e.jsx(q,{refreshKey:Math.random()}),e.jsxs("div",{className:"mb-4 grid grid-cols-3 gap-3 items-center",children:[e.jsx("input",{className:"col-span-2 p-2 rounded border",placeholder:"domain.com",value:u,onChange:s=>p(s.target.value)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"flex-1 p-2 rounded border",placeholder:"minutes",value:y,onChange:s=>j(s.target.value)}),e.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white",onClick:b,children:"Add"})]})]}),e.jsxs("div",{className:"mb-3 flex items-center gap-3",children:[e.jsx("button",{className:"px-3 py-2 rounded bg-indigo-500 text-white",onClick:()=>x(15),children:"Set 15m for selected"}),e.jsx("button",{className:"px-3 py-2 rounded bg-indigo-500 text-white",onClick:()=>x(30),children:"Set 30m for selected"})]}),e.jsx("div",{className:"overflow-auto max-h-[60vh]",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-sm text-gray-500",children:[e.jsx("th",{className:"py-2 w-8"}),e.jsx("th",{className:"py-2",children:"Domain"}),e.jsx("th",{className:"py-2",children:"Usage"}),e.jsx("th",{className:"py-2",children:"Limit"}),e.jsx("th",{className:"py-2",children:"Actions"})]})}),e.jsxs("tbody",{children:[f.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"py-4",colSpan:"5",children:"No domains tracked yet."})}),f.map(s=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2 align-top",children:e.jsx("input",{type:"checkbox",checked:!!d[s],onChange:r=>m(c=>({...c,[s]:r.target.checked})),"aria-label":`Select ${s}`})}),e.jsx("td",{className:"py-2 align-top",children:s}),e.jsx("td",{className:"py-2 align-top",children:T(t.usage[s])}),e.jsx("td",{className:"py-2 align-top",children:t.limits[s]?`${t.limits[s]} min`:"—"}),e.jsxs("td",{className:"py-2 align-top",children:[e.jsxs("button",{className:"mr-2 px-2 py-1 rounded border text-sm",onClick:()=>N(s),"aria-label":`Remove limit for ${s}`,children:[e.jsx(M,{className:"w-4 h-4 inline-block"})," Remove"]}),e.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white text-sm",onClick:()=>i(s),children:t.blocked[s]?"Unblock":"Block"})]})]},s))]})]})})]})})}const C=document.getElementById("root");C&&$(C).render(e.jsx(H,{}));
